generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-1.1.x"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./sqlite.db?connection_limit=1"
}

model Chat {
  id        BigInt    @id
  type      String
  title     String?
  username  String?
  firstName String?
  lastName  String?
  messages  Message[]
}

model DateTimeSetting {
  setting  String   @id
  dateTime DateTime
}

model Message {
  messageId            Int
  chat                 Chat      @relation(fields: [chatId], references: [id])
  chatId               BigInt
  from                 User      @relation(fields: [fromId], references: [id])
  fromId               BigInt
  sentAt               DateTime
  editedAt             DateTime?
  replyToMessage       Message?  @relation("ReplyToMessage", fields: [replyToMessageId, replyToMessageChatId], references: [messageId, chatId])
  replyToMessageId     Int?
  replyToMessageChatId BigInt?
  text                 String?
  replies              Message[] @relation("ReplyToMessage")

  @@id([messageId, chatId], name: "id")
}

model User {
  id           BigInt    @id
  isBot        Boolean
  firstName    String
  lastName     String?
  username     String?
  languageCode String?
  messages     Message[]
}
